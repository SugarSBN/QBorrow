alloc q[4];


X[q[1]];
CNOT[q[2], q[3]];


borrow anc;

    CCNOT[q[1], q[2], anc];
    CCNOT[anc, q[3], q[4]];
    CCNOT[q[1], q[2], anc];
    CCNOT[anc, q[3], q[4]];

release anc;

release q;